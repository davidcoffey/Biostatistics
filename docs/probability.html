<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Biostatistics</title>
  <meta name="description" content="Principles of biostatistics and how to apply them using the R programming language.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Biostatistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Principles of biostatistics and how to apply them using the R programming language." />
  <meta name="github-repo" content="davidcoffey/Biostatistics" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Biostatistics" />
  
  <meta name="twitter:description" content="Principles of biostatistics and how to apply them using the R programming language." />
  

<meta name="author" content="David Coffey">


<meta name="date" content="2018-07-27">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="descriptive-statistics.html">
<link rel="next" href="normal-distribution.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Biostatistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> General overview</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#example-dataset"><i class="fa fa-check"></i><b>1.2</b> Example dataset</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html"><i class="fa fa-check"></i><b>2</b> Descriptive statistics</a><ul>
<li class="chapter" data-level="2.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#measures-of-location"><i class="fa fa-check"></i><b>2.1</b> Measures of location</a><ul>
<li class="chapter" data-level="2.1.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#arithmetic-mean"><i class="fa fa-check"></i><b>2.1.1</b> Arithmetic mean</a></li>
<li class="chapter" data-level="2.1.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#median"><i class="fa fa-check"></i><b>2.1.2</b> Median</a></li>
<li class="chapter" data-level="2.1.3" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#mode"><i class="fa fa-check"></i><b>2.1.3</b> Mode</a></li>
<li class="chapter" data-level="2.1.4" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#geometric-mean"><i class="fa fa-check"></i><b>2.1.4</b> Geometric mean</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#measures-of-spread"><i class="fa fa-check"></i><b>2.2</b> Measures of spread</a><ul>
<li class="chapter" data-level="2.2.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#range"><i class="fa fa-check"></i><b>2.2.1</b> Range</a></li>
<li class="chapter" data-level="2.2.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#percentile"><i class="fa fa-check"></i><b>2.2.2</b> Percentile</a></li>
<li class="chapter" data-level="2.2.3" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#variance"><i class="fa fa-check"></i><b>2.2.3</b> Variance</a></li>
<li class="chapter" data-level="2.2.4" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#standard-deviation"><i class="fa fa-check"></i><b>2.2.4</b> Standard deviation</a></li>
<li class="chapter" data-level="2.2.5" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#standard-error-of-the-mean"><i class="fa fa-check"></i><b>2.2.5</b> Standard error of the mean</a></li>
<li class="chapter" data-level="2.2.6" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#coefficient-of-varaince"><i class="fa fa-check"></i><b>2.2.6</b> Coefficient of varaince</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#visualizing-descriptive-statistics"><i class="fa fa-check"></i><b>2.3</b> Visualizing descriptive statistics</a><ul>
<li class="chapter" data-level="2.3.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#single-variable"><i class="fa fa-check"></i><b>2.3.1</b> Single variable</a></li>
<li class="chapter" data-level="2.3.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#muliple-variables"><i class="fa fa-check"></i><b>2.3.2</b> Muliple variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>3</b> Probability</a><ul>
<li class="chapter" data-level="3.1" data-path="probability.html"><a href="probability.html#table-of-confusion"><i class="fa fa-check"></i><b>3.1</b> Table of confusion</a></li>
<li class="chapter" data-level="3.2" data-path="probability.html"><a href="probability.html#sensitivity"><i class="fa fa-check"></i><b>3.2</b> Sensitivity</a></li>
<li class="chapter" data-level="3.3" data-path="probability.html"><a href="probability.html#specificity"><i class="fa fa-check"></i><b>3.3</b> Specificity</a></li>
<li class="chapter" data-level="3.4" data-path="probability.html"><a href="probability.html#postitive-predictive-value"><i class="fa fa-check"></i><b>3.4</b> Postitive predictive value</a></li>
<li class="chapter" data-level="3.5" data-path="probability.html"><a href="probability.html#negative-predictive-value"><i class="fa fa-check"></i><b>3.5</b> Negative predictive value</a></li>
<li class="chapter" data-level="3.6" data-path="probability.html"><a href="probability.html#roc-curve"><i class="fa fa-check"></i><b>3.6</b> ROC curve</a></li>
<li class="chapter" data-level="3.7" data-path="probability.html"><a href="probability.html#baysian-inference"><i class="fa fa-check"></i><b>3.7</b> Baysian inference</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="normal-distribution.html"><a href="normal-distribution.html"><i class="fa fa-check"></i><b>4</b> Normal distribution</a><ul>
<li class="chapter" data-level="4.1" data-path="normal-distribution.html"><a href="normal-distribution.html#probability-distributions"><i class="fa fa-check"></i><b>4.1</b> Probability distributions</a></li>
<li class="chapter" data-level="4.2" data-path="normal-distribution.html"><a href="normal-distribution.html#central-limit-theorem"><i class="fa fa-check"></i><b>4.2</b> Central limit theorem</a></li>
<li class="chapter" data-level="4.3" data-path="normal-distribution.html"><a href="normal-distribution.html#test-for-normality"><i class="fa fa-check"></i><b>4.3</b> Test for normality</a></li>
<li class="chapter" data-level="4.4" data-path="normal-distribution.html"><a href="normal-distribution.html#quantile-quantile-plot"><i class="fa fa-check"></i><b>4.4</b> Quantile-quantile plot</a></li>
<li class="chapter" data-level="4.5" data-path="normal-distribution.html"><a href="normal-distribution.html#confidence-interval"><i class="fa fa-check"></i><b>4.5</b> Confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Biostatistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="probability" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Probability</h1>
<div id="table-of-confusion" class="section level2">
<h2><span class="header-section-number">3.1</span> Table of confusion</h2>
<p>A table of confusion is a table with 2 rows and 2 columns that reports the number of false positives, false negatives, true positives, and true negatives. Rows represent a prediction outcomes such as a test result and columns represent outcomes of the condition being predicted such as a disease state.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Import dataset</span>
<span class="kw">load</span>(<span class="st">&quot;docs/Example-data.Rda&quot;</span>)

<span class="co"># Create a table of confusion</span>
BonyLesions &lt;-<span class="st"> </span><span class="kw">ifelse</span>(data<span class="op">$</span>BonyLesions <span class="op">!=</span><span class="st"> &quot;0&quot;</span> , <span class="st">&quot;Abnormal&quot;</span>, <span class="st">&quot;Normal&quot;</span>)
MProtein &lt;-<span class="st"> </span><span class="kw">ifelse</span>(data<span class="op">$</span>MProtein <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> , <span class="st">&quot;Abnormal&quot;</span>, <span class="st">&quot;Normal&quot;</span>)
<span class="kw">table</span>(MProtein, BonyLesions)</code></pre></div>
<pre><code>          BonyLesions
MProtein   Abnormal Normal
  Abnormal        9      6
  Normal          4      1</code></pre>
<p>Sensitivity and specificity to assess the quality of a test. Positive and negative predictive values to interpret the results of the test.</p>
</div>
<div id="sensitivity" class="section level2">
<h2><span class="header-section-number">3.2</span> Sensitivity</h2>
<p>Sensitivity is the ability of a test to correctly classify an individual as having a disease. It is defined by the probability of having a positive test when the disease is present: <span class="math display">\[{\frac{True\ positives}{True\ positives + False\ negatives}=\frac{True\ positives}{Number\ with\ condition}}\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate sensitivity</span>
<span class="kw">library</span>(caret)
<span class="kw">sensitivity</span>(<span class="kw">factor</span>(MProtein), <span class="kw">factor</span>(BonyLesions)) <span class="co"># sensitivity(prediction,truth)</span></code></pre></div>
<pre><code>[1] 0.6923077</code></pre>
</div>
<div id="specificity" class="section level2">
<h2><span class="header-section-number">3.3</span> Specificity</h2>
<p>Specificity is the ability of a test to correctly classify an individual disease free. It is defined by the probability of having a negative test when the disease absent: <span class="math display">\[{\frac{True\ negatives}{True\ negatives + False\ positives}=\frac{True\ negatives}{Number\ without\ condition}}\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate specificity</span>
<span class="kw">library</span>(caret)
<span class="kw">specificity</span>(<span class="kw">factor</span>(MProtein), <span class="kw">factor</span>(BonyLesions)) <span class="co"># specificity(prediction,truth)</span></code></pre></div>
<pre><code>[1] 0.1428571</code></pre>
</div>
<div id="postitive-predictive-value" class="section level2">
<h2><span class="header-section-number">3.4</span> Postitive predictive value</h2>
<p>Positive predictive value is the percentage of patients with a positive test who actually have the disease. It is defined by the probability of having the disease when the test is positive: <span class="math display">\[{\frac{True\ positives}{True\ positives + False\ positives}=\frac{True\ positives}{Postive\ predictions}}\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate postitive predictive value</span>
<span class="kw">library</span>(caret)
<span class="kw">posPredValue</span>(<span class="kw">factor</span>(MProtein), <span class="kw">factor</span>(BonyLesions)) <span class="co"># posPredValue(prediction,truth)</span></code></pre></div>
<pre><code>[1] 0.6</code></pre>
</div>
<div id="negative-predictive-value" class="section level2">
<h2><span class="header-section-number">3.5</span> Negative predictive value</h2>
<p>Negative predictive value is the percentage of patients with a negative test who do not have the disease. It is defined by the probability of not having the disease when the test is negative: <span class="math display">\[{\frac{True\ negataives}{True\ negatives + False\ negatives}=\frac{True\ positives}{Negative\ predictions}}\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate negative predictive value</span>
<span class="kw">library</span>(caret)
<span class="kw">negPredValue</span>(<span class="kw">factor</span>(MProtein), <span class="kw">factor</span>(BonyLesions)) <span class="co"># negPredValue(prediction,truth)</span></code></pre></div>
<pre><code>[1] 0.2</code></pre>
</div>
<div id="roc-curve" class="section level2">
<h2><span class="header-section-number">3.6</span> ROC curve</h2>
<p>The receiver operating characteristics (ROC) curve is a plot of the true positive rate versus (sensitivity) versus the false positive rate (specificity) of a screening test. Each point on the curve corresponds to different cutoff points used to designate a positive test. The area under the curve is an estimate of the accuracy of the test.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(plotROC)
<span class="kw">library</span>(ggplot2)

<span class="kw">ggplot</span>(<span class="kw">data.frame</span>(BonyLesions, <span class="dt">MProtein =</span> data<span class="op">$</span>MProtein), <span class="kw">aes</span>(<span class="dt">d =</span> BonyLesions, <span class="dt">m =</span> MProtein)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_roc</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">style_roc</span>()</code></pre></div>
<p><img src="Biostatistics_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate area under the curve</span>
<span class="kw">calc_auc</span>(
  <span class="kw">ggplot</span>(<span class="kw">data.frame</span>(BonyLesions, <span class="dt">MProtein =</span> data<span class="op">$</span>MProtein), <span class="kw">aes</span>(<span class="dt">d =</span> BonyLesions, <span class="dt">m =</span> MProtein)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_roc</span>()
  )</code></pre></div>
<pre><code>  PANEL group      AUC
1     1    -1 0.521978</code></pre>
</div>
<div id="baysian-inference" class="section level2">
<h2><span class="header-section-number">3.7</span> Baysian inference</h2>
<p>Frequentist inference is a type of statistical inference that draws conclusions from sample data by emphasizing the frequency or proportion of the data. Bayesian inference is an alternative method of statistical inference in which Bayes’ theorem is used to update the probability for a hypothesis as more evidence or information becomes available. It is given by the following formula: <span class="math display">\[Baye&#39;s\ theorem = {Pr({A|B})=\frac{Pr(B|A)\times Pr(A)}{Pr(B)}}\]</span> where <span class="math inline">\({Pr({A|B})}\)</span> the likelihood of event <span class="math inline">\({A}\)</span> occurring given that <span class="math inline">\({B}\)</span> is true, <span class="math inline">\({Pr({B|A})}\)</span> the likelihood of event <span class="math inline">\({B}\)</span> occurring given that <span class="math inline">\({A}\)</span> is true, and <span class="math inline">\({Pr({A)}}\)</span> and <span class="math inline">\({Pr(A)}\)</span> are the probabilities of observing A and B independently of each other. Bayesians conceive of two types of probability, a <strong>prior probability</strong> of an event which is the best guess by the observer in the absence of data, and a <strong>posterior probability</strong> which is the likelihood that an event will occur after collecting some empirical data.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="descriptive-statistics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="normal-distribution.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["Biostatistics.pdf", "Biostatistics.epub"],
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "fixed"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
